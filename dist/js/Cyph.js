(function(t,e,n){"use strict";var r=function(){return v.__string_rec(this,"")};function i(t,e){function n(){}n.prototype=t;var r=new n;for(var i in e)r[i]=e[i];if(e.toString!==Object.prototype.toString)r.toString=e.toString;return r}var a=function(){};a.__name__=true;a.cca=function(t,e){var n=t.charCodeAt(e);if(n!=n)return undefined;return n};a.indexOf=function(t,e,n){var r=t.length;if(n<0){n+=r;if(n<0)n=0}while(n<r){if(t[n]===e)return n;n++}return-1};var s=e.Cyph=function(){};s.__name__=true;s.generateGuid=function(t){var e=o.getSecureRandomBytes(t);var n=0;while(n<t){var r=n++;e.set(r,s.addressSpace[Math.floor(e.b[r]/256*s.addressSpace.length)])}var i=e.toString();e.fill(0,t,0);return i};s.initiateSession=function(t){if(t==null)t=[];return"https://"+(a.indexOf(t,s.options.video,0)>-1?s.services.video:a.indexOf(t,s.options.voice,0)>-1?s.services.voice:s.services.chat)+"/#"+(a.indexOf(t,s.options.modestBranding,0)>-1?"&":"")+(a.indexOf(t,s.options.disableP2P,0)>-1?"$":"")+(a.indexOf(t,s.options.nativeCrypto,0)>-1?"%":"")+s.generateGuid(26)};Math.__name__=true;var o=function(){};o.__name__=true;o.getSecureRandomBytes=function(t){var e="";try{var n=crypto||require("crypto");var r=n.randomBytes?n.randomBytes(t):n.getRandomValues(new C(t));var i=_.alloc(t);var a=0;while(a<t){var s=a++;i.b[s]=r[s]&255}return i}catch(o){if(o instanceof c)o=o.val;e=""+u.string(o)}throw new c("Can't find a secure source of random bytes. Reason: "+e)};var u=function(){};u.__name__=true;u.string=function(t){return v.__string_rec(t,"")};var f=function(t,e){this.high=t;this.low=e};f.__name__=true;f.prototype={__class__:f};var _=function(t){this.length=t.byteLength;this.b=new C(t);this.b.bufferValue=t;t.hxBytes=this;t.bytes=this.b};_.__name__=true;_.alloc=function(t){return new _(new B(t))};_.prototype={set:function(t,e){this.b[t]=e&255},fill:function(t,e,n){var r=0;while(r<e){var i=r++;this.set(t++,n)}},getString:function(t,e){if(t<0||e<0||t+e>this.length)throw new c(l.OutsideBounds);var n="";var r=this.b;var i=String.fromCharCode;var a=t;var s=t+e;while(a<s){var o=r[a++];if(o<128){if(o==0)break;n+=i(o)}else if(o<224)n+=i((o&63)<<6|r[a++]&127);else if(o<240){var u=r[a++];n+=i((o&31)<<12|(u&127)<<6|r[a++]&127)}else{var f=r[a++];var _=r[a++];var h=(o&15)<<18|(f&127)<<12|(_&127)<<6|r[a++]&127;n+=i((h>>10)+55232);n+=i(h&1023|56320)}}return n},toString:function(){return this.getString(0,this.length)},__class__:_};var l={__ename__:true,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};l.Blocked=["Blocked",0];l.Blocked.toString=r;l.Blocked.__enum__=l;l.Overflow=["Overflow",1];l.Overflow.toString=r;l.Overflow.__enum__=l;l.OutsideBounds=["OutsideBounds",2];l.OutsideBounds.toString=r;l.OutsideBounds.__enum__=l;l.Custom=function(t){var e=["Custom",3,t];e.__enum__=l;e.toString=r;return e};var h=function(){};h.__name__=true;h.i32ToFloat=function(t){var e=1-(t>>>31<<1);var n=t>>>23&255;var r=t&8388607;if(r==0&&n==0)return 0;return e*(1+Math.pow(2,-23)*r)*Math.pow(2,n-127)};h.floatToI32=function(t){if(t==0)return 0;var e;if(t<0)e=-t;else e=t;var n=Math.floor(Math.log(e)/.6931471805599453);if(n<-127)n=-127;else if(n>128)n=128;var r=Math.round((e/Math.pow(2,n)-1)*8388608)&8388607;return(t<0?-2147483648:0)|n+127<<23|r};h.i64ToDouble=function(t,e){var n=1-(e>>>31<<1);var r=(e>>20&2047)-1023;var i=(e&1048575)*4294967296+(t>>>31)*2147483648+(t&2147483647);if(i==0&&r==-1023)return 0;return n*(1+Math.pow(2,-52)*i)*Math.pow(2,r)};h.doubleToI64=function(t){var e=h.i64tmp;if(t==0){e.low=0;e.high=0}else{var n;if(t<0)n=-t;else n=t;var r=Math.floor(Math.log(n)/.6931471805599453);var i;var a=(n/Math.pow(2,r)-1)*4503599627370496;i=Math.round(a);var s=i|0;var o=i/4294967296|0;e.low=s;e.high=(t<0?-2147483648:0)|r+1023<<20|o}return e};var c=function(t){Error.call(this);this.val=t;this.message=String(t);if(Error.captureStackTrace)Error.captureStackTrace(this,c)};c.__name__=true;c.__super__=Error;c.prototype=i(Error.prototype,{__class__:c});var v=function(){};v.__name__=true;v.getClass=function(t){if(t instanceof Array&&t.__enum__==null)return Array;else{var e=t.__class__;if(e!=null)return e;var n=v.__nativeClassName(t);if(n!=null)return v.__resolveNativeClass(n);return null}};v.__string_rec=function(t,e){if(t==null)return"null";if(e.length>=5)return"<...>";var n=typeof t;if(n=="function"&&(t.__name__||t.__ename__))n="object";switch(n){case"object":if(t instanceof Array){if(t.__enum__){if(t.length==2)return t[0];var r=t[0]+"(";e+="	";var i=2;var a=t.length;while(i<a){var s=i++;if(s!=2)r+=","+v.__string_rec(t[s],e);else r+=v.__string_rec(t[s],e)}return r+")"}var o=t.length;var u;var f="[";e+="	";var _=0;while(_<o){var l=_++;f+=(l>0?",":"")+v.__string_rec(t[l],e)}f+="]";return f}var h;try{h=t.toString}catch(g){if(g instanceof c)g=g.val;return"???"}if(h!=null&&h!=Object.toString&&typeof h=="function"){var p=t.toString();if(p!="[object Object]")return p}var b=null;var y="{\n";e+="	";var d=t.hasOwnProperty!=null;for(var b in t){if(d&&!t.hasOwnProperty(b)){continue}if(b=="prototype"||b=="__class__"||b=="__super__"||b=="__interfaces__"||b=="__properties__"){continue}if(y.length!=2)y+=", \n";y+=e+b+" : "+v.__string_rec(t[b],e)}e=e.substring(1);y+="\n"+e+"}";return y;case"function":return"<function>";case"string":return t;default:return String(t)}};v.__interfLoop=function(t,e){if(t==null)return false;if(t==e)return true;var n=t.__interfaces__;if(n!=null){var r=0;var i=n.length;while(r<i){var a=r++;var s=n[a];if(s==e||v.__interfLoop(s,e))return true}}return v.__interfLoop(t.__super__,e)};v.__instanceof=function(t,e){if(e==null)return false;switch(e){case y:return(t|0)===t;case w:return typeof t=="number";case m:return typeof t=="boolean";case String:return typeof t=="string";case Array:return t instanceof Array&&t.__enum__==null;case d:return true;default:if(t!=null){if(typeof e=="function"){if(t instanceof e)return true;if(v.__interfLoop(v.getClass(t),e))return true}else if(typeof e=="object"&&v.__isNativeObj(e)){if(t instanceof e)return true}}else return false;if(e==O&&t.__name__!=null)return true;if(e==S&&t.__ename__!=null)return true;return t.__enum__==e}};v.__nativeClassName=function(t){var e=v.__toStr.call(t).slice(8,-1);if(e=="Object"||e=="Function"||e=="Math"||e=="JSON")return null;return e};v.__isNativeObj=function(t){return v.__nativeClassName(t)!=null};v.__resolveNativeClass=function(t){return n[t]};var g=function(t){if(t instanceof Array&&t.__enum__==null){this.a=t;this.byteLength=t.length}else{var e=t;this.a=[];var n=0;while(n<e){var r=n++;this.a[r]=0}this.byteLength=e}};g.__name__=true;g.sliceImpl=function(t,e){var n=new C(this,t,e==null?null:e-t);var r=new B(n.byteLength);var i=new C(r);i.set(n);return r};g.prototype={slice:function(t,e){return new g(this.a.slice(t,e))},__class__:g};var p=function(t,e,n){this.buf=t;if(e==null)this.offset=0;else this.offset=e;if(n==null)this.length=t.byteLength-this.offset;else this.length=n;if(this.offset<0||this.length<0||this.offset+this.length>t.byteLength)throw new c(l.OutsideBounds)};p.__name__=true;p.prototype={getInt8:function(t){var e=this.buf.a[this.offset+t];if(e>=128)return e-256;else return e},getUint8:function(t){return this.buf.a[this.offset+t]},getInt16:function(t,e){var n=this.getUint16(t,e);if(n>=32768)return n-65536;else return n},getUint16:function(t,e){if(e)return this.buf.a[this.offset+t]|this.buf.a[this.offset+t+1]<<8;else return this.buf.a[this.offset+t]<<8|this.buf.a[this.offset+t+1]},getInt32:function(t,e){var n=this.offset+t;var r=this.buf.a[n++];var i=this.buf.a[n++];var a=this.buf.a[n++];var s=this.buf.a[n++];if(e)return r|i<<8|a<<16|s<<24;else return s|a<<8|i<<16|r<<24},getUint32:function(t,e){var n=this.getInt32(t,e);if(n<0)return n+4294967296;else return n},getFloat32:function(t,e){return h.i32ToFloat(this.getInt32(t,e))},getFloat64:function(t,e){var n=this.getInt32(t,e);var r=this.getInt32(t+4,e);return h.i64ToDouble(e?n:r,e?r:n)},setInt8:function(t,e){if(e<0)this.buf.a[t+this.offset]=e+128&255;else this.buf.a[t+this.offset]=e&255},setUint8:function(t,e){this.buf.a[t+this.offset]=e&255},setInt16:function(t,e,n){this.setUint16(t,e<0?e+65536:e,n)},setUint16:function(t,e,n){var r=t+this.offset;if(n){this.buf.a[r]=e&255;this.buf.a[r++]=e>>8&255}else{this.buf.a[r++]=e>>8&255;this.buf.a[r]=e&255}},setInt32:function(t,e,n){this.setUint32(t,e,n)},setUint32:function(t,e,n){var r=t+this.offset;if(n){this.buf.a[r++]=e&255;this.buf.a[r++]=e>>8&255;this.buf.a[r++]=e>>16&255;this.buf.a[r++]=e>>>24}else{this.buf.a[r++]=e>>>24;this.buf.a[r++]=e>>16&255;this.buf.a[r++]=e>>8&255;this.buf.a[r++]=e&255}},setFloat32:function(t,e,n){this.setUint32(t,h.floatToI32(e),n)},setFloat64:function(t,e,n){var r=h.doubleToI64(e);if(n){this.setUint32(t,r.low);this.setUint32(t,r.high)}else{this.setUint32(t,r.high);this.setUint32(t,r.low)}},__class__:p};var b=function(){};b.__name__=true;b._new=function(t,e,n){var r;if(typeof t=="number"){r=[];var i=0;while(i<t){var a=i++;r[a]=0}r.byteLength=r.length;r.byteOffset=0;r.buffer=new g(r)}else if(v.__instanceof(t,g)){var s=t;if(e==null)e=0;if(n==null)n=s.byteLength-e;if(e==0)r=s.a;else r=s.a.slice(e,e+n);r.byteLength=r.length;r.byteOffset=e;r.buffer=s}else if(t instanceof Array&&t.__enum__==null){r=t.slice();r.byteLength=r.length;r.byteOffset=0;r.buffer=new g(r)}else throw new c("TODO "+u.string(t));r.subarray=b._subarray;r.set=b._set;return r};b._set=function(t,e){var n=this;if(v.__instanceof(t.buffer,g)){var r=t;if(t.byteLength+e>n.byteLength)throw new c("set() outside of range");var i=0;var a=t.byteLength;while(i<a){var s=i++;n[s+e]=r[s]}}else if(t instanceof Array&&t.__enum__==null){var o=t;if(o.length+e>n.byteLength)throw new c("set() outside of range");var u=0;var f=o.length;while(u<f){var _=u++;n[_+e]=o[_]}}else throw new c("TODO")};b._subarray=function(t,e){var n=this;var r=b._new(n.slice(t,e));r.byteOffset=t;return r};if(Array.prototype.indexOf)a.indexOf=function(t,e,n){return Array.prototype.indexOf.call(t,e,n)};String.prototype.__class__=String;String.__name__=true;Array.__name__=true;var y={__name__:["Int"]};var d={__name__:["Dynamic"]};var w=Number;w.__name__=["Float"];var m=Boolean;m.__ename__=["Bool"];var O={__name__:["Class"]};var S={};if(Array.prototype.map==null)Array.prototype.map=function(t){var e=[];var n=0;var r=this.length;while(n<r){var i=n++;e[i]=t(this[i])}return e};var B=n.ArrayBuffer||g;if(B.prototype.slice==null)B.prototype.slice=g.sliceImpl;var L=n.DataView||p;var C=n.Uint8Array||b._new;s.addressSpace=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"].map(function(t){return a.cca(t,0)});s.services={chat:"cyph.im",voice:"cyph.audio",video:"cyph.video"};s.options={voice:1,video:2,modestBranding:3,disableP2P:4,nativeCrypto:5};h.i64tmp=function(t){var e;var n=new f(0,0);e=n;return e}(this);v.__toStr={}.toString;b.BYTES_PER_ELEMENT=1})(typeof console!="undefined"?console:{log:function(){}},typeof window!="undefined"?window:exports,typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this);